<html>
	<head>
		<meta http-equiv="Content-type" content="text/html; charset=utf-8">
		<title>mod tests</title>
		<!-- Just load mod -->
		<script src="tests/assert.js" type="text/javascript" charset="utf-8"></script>
		<script src="mod.js" type="text/javascript" charset="utf-8"></script>
	</head>
	<body id="index" onload="onload">
		<script type="text/javascript" charset="utf-8">
			var initMod = function () {
				if (mod.reset) {
					mod.reset();
				}
				mod.modules = {
					testSeq : ''
				};
				mod.nocache = true;
				mod.useTagInjection = true;
                mod.basePath = 'tests/';
			};	
			var onload = function () {
				initMod();
				
				var callbackCount = 0;
				
				// create the main module
				mod({
					name : 'main',
					dependencies : [
						'parallel.js',
						't1.js'
					],
					init : function initMain(modules) {
						// is module tests
						assert.eq(mod.isModule({
							name : 'ismod'
						}), false, 'Object with only name is not a module');
						assert.eq(mod.isModule({
							name : 'ismod',
							dependencies : []
						}), false, 'Object without init function is not a module');
						assert.eq(mod.isModule({
							name : 'ismod',
							init : function () {}
						}), true, 'Object with only name and init function is a module');
						
						mod({
							name : 'canDefineModWithoutDependencies',
							init : function () {
								return {
									data : [0, 1, 2, 3]
								};
							}
						});
						return {};
					},
					callback : function cbMain(modules) {
						assert.suite = 'Overall Tests';
						callbackCount++;
						assert.eq('canDefineModWithoutDependencies' in modules, true, 'Can define module without dependencies');
						assert.eq(callbackCount, 1, 'Callbacks are only called once (can define module in init)');
						assert.stat();
						if (false) {
							var compiled = mod.compile();
							initMod();
							assert.suite = "Compile tests";
							eval(compiled);	
							document.write('<pre>'+compiled+'</pre>');
						}
						
					}
				});
			}
		</script>
	</body>
</html>